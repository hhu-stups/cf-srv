<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<org.eventb.core.machineFile org.eventb.core.configuration="org.eventb.core.fwd" org.eventb.core.generated="false" org.eventb.texttools.text_lastmodified="1767960574060" org.eventb.texttools.text_representation="machine M6_Quadcopter_Concrete_Movement refines M5_Quadcopter_Mission_Status  sees M6_Quadcopter_Concrete_Movement_Ctx&#10;&#10;variables mode sensor_data_actual position_actual battery battery_actual current_position visited field emergency_mode mission_failed concrete_position&#10;&#10;invariants&#10;  @conrete_pos_type concrete_position ∈ ℤ × ℤ&#10;  @glueing_inv_1 prj1(concrete_position) ∈ MAP_TO_ABSTRACT_POS∼[{prj1(current_position)}]&#10;  @glueing_inv_2 prj2(concrete_position) ∈ MAP_TO_ABSTRACT_POS∼[{prj2(current_position)}]&#10;&#10;events&#10;  event INITIALISATION extends INITIALISATION&#10;    then&#10;      @init_concrete_pos concrete_position :∣ prj1(concrete_position') ∈ MAP_TO_ABSTRACT_POS∼[{prj1(BASE_POSITION)}] ∧ prj2(concrete_position') ∈ MAP_TO_ABSTRACT_POS∼[{prj2(BASE_POSITION)}]&#10;  end&#10;&#10;  event TAKEOFF extends TAKEOFF&#10;  end&#10;&#10;  event MOVE_RIGHT extends MOVE_RIGHT&#10;    where&#10;      @grd_concrete_pos_does_not_move_outside prj1(concrete_position) ≥ GRID_SIZE&#10;    then&#10;      @act_concrete_pos concrete_position :∣ prj1(concrete_position') ∈ MAP_TO_ABSTRACT_POS∼[{prj1(current_position) − 1}] ∧ prj2(concrete_position') = prj2(concrete_position)&#10;  end&#10;&#10;  event MOVE_LEFT extends MOVE_LEFT&#10;    where&#10;      @grd_concrete_pos_does_not_move_outside prj1(concrete_position) ≤ CONCRETE_WIDTH − GRID_SIZE&#10;    then&#10;      @act_concrete_pos concrete_position :∣ prj1(concrete_position') ∈ MAP_TO_ABSTRACT_POS∼[{prj1(current_position) + 1}] ∧ prj2(concrete_position') = prj2(concrete_position)&#10;  end&#10;&#10;  event MOVE_BACKWARD extends MOVE_BACKWARD&#10;    where&#10;      @grd_concrete_pos_does_not_move_outside prj2(concrete_position)≥ GRID_SIZE&#10;    then&#10;      @act_concrete_pos concrete_position :∣ prj1(concrete_position') = prj1(concrete_position) ∧ prj2(concrete_position') ∈ MAP_TO_ABSTRACT_POS∼[{prj2(current_position) − 1}]&#10;  end&#10;&#10;  event MOVE_FORWARD extends MOVE_FORWARD&#10;    where&#10;      @grd_concrete_pos_does_not_move_outside prj2(concrete_position) ≤ CONCRETE_DEPTH − GRID_SIZE&#10;    then&#10;      @act_concrete_pos concrete_position :∣ prj1(concrete_position') = prj1(concrete_position) ∧ prj2(concrete_position') ∈ MAP_TO_ABSTRACT_POS∼[{prj2(current_position) + 1}]&#10;  end&#10;&#10;  event LAND extends LAND&#10;  end&#10;&#10;  event OBSERVE refines OBSERVE&#10;    any concrete_left_sensor concrete_right_sensor concrete_forward_sensor concrete_backward_sensor&#10;    where&#10;      @grd_concrete_left_sensor concrete_left_sensor ∈ ℕ&#10;      @grd_concrete_right_sensor concrete_right_sensor ∈ ℕ&#10;      @grd_concrete_forward_sensor concrete_forward_sensor ∈ ℕ&#10;      @grd_concrete_backward_sensor concrete_backward_sensor ∈ ℕ&#10;      @grd_emergency emergency_mode = FALSE&#10;      @grd_mode mode = FLYING&#10;      @grd_position position_actual = TRUE&#10;      @grd_Battery battery &gt; BATTERY_STEP&#10;      @grd_battery_actual battery_actual = TRUE&#10;    with&#10;      @right_sensor (concrete_right_sensor &lt; prj1(concrete_position) mod GRID_SIZE ∧ right_sensor = 0) ∨ (concrete_right_sensor ≥ prj1(concrete_position) mod GRID_SIZE ∧ concrete_right_sensor &lt; GRID_SIZE + prj1(concrete_position) mod GRID_SIZE ∧ right_sensor = 2) ∨ ((concrete_right_sensor ≥ GRID_SIZE + prj1(concrete_position) mod GRID_SIZE) ∧ right_sensor = 1)&#10;      @left_sensor (concrete_left_sensor &lt; (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE) ∧ left_sensor = 0) ∨ (concrete_left_sensor ≥ (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE) ∧ concrete_left_sensor &lt; GRID_SIZE + (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE) ∧ left_sensor = 2) ∨ ((concrete_left_sensor ≥ GRID_SIZE + (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE)) ∧ left_sensor = 1)&#10;      @backward_sensor (concrete_backward_sensor &lt; prj2(concrete_position) mod GRID_SIZE ∧ backward_sensor = 0) ∨ (concrete_backward_sensor ≥ prj2(concrete_position) mod GRID_SIZE ∧ concrete_backward_sensor &lt; GRID_SIZE + prj2(concrete_position) mod GRID_SIZE ∧ backward_sensor = 2) ∨ ((concrete_backward_sensor ≥ GRID_SIZE + prj2(concrete_position) mod GRID_SIZE) ∧ backward_sensor = 1)&#10;      @forward_sensor (concrete_forward_sensor &lt; (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE) ∧ forward_sensor = 0) ∨ (concrete_forward_sensor ≥ (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE) ∧ concrete_forward_sensor &lt; GRID_SIZE + (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE) ∧ forward_sensor = 2) ∨ ((concrete_forward_sensor ≥ GRID_SIZE + (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE)) ∧ forward_sensor = 1)&#10;    then&#10;      @act_sensor_data_actual sensor_data_actual ≔ TRUE&#10;      @act_battery_actual battery_actual ≔ FALSE&#10;      @act_field field ≔ field  (&#10;                 {x,y,val · x = prj1(current_position) ∧ y = prj2(current_position) ∧ x ∈ 1‥ WIDTH ∧ y ∈ 1‥ DEPTH ∧ val ∈ {1,2} ∧&#10;                 (((concrete_right_sensor &lt; prj1(concrete_position) mod GRID_SIZE ∨ concrete_left_sensor &lt; (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE) ∨ concrete_forward_sensor &lt; (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE) ∨ concrete_backward_sensor &lt; prj2(concrete_position) mod GRID_SIZE) ∧ val = 2) ∨ (¬(concrete_right_sensor &lt; prj1(concrete_position) mod GRID_SIZE ∨ concrete_left_sensor &lt; (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE) ∨ concrete_forward_sensor &lt; (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE) ∨ concrete_backward_sensor &lt; prj2(concrete_position) mod GRID_SIZE) ∧ val = 1)) ∣ x ↦ y ↦ val} ∪&#10;&#10;                 {x,y,val · x = prj1(current_position) − 1 ∧ y = prj2(current_position) ∧ x ∈ 1‥ WIDTH ∧ y ∈ 1‥ DEPTH ∧ val ∈ {1,2} ∧&#10;                 (((concrete_right_sensor ≥ prj1(concrete_position) mod GRID_SIZE ∧ concrete_right_sensor &lt; GRID_SIZE + prj1(concrete_position) mod GRID_SIZE) ∧ val = 2) ∨ ((concrete_right_sensor ≥ GRID_SIZE + prj1(concrete_position) mod GRID_SIZE) ∧ val = 1)) ∣ x ↦ y ↦ val} ∪&#10;&#10;                 {x,y,val · x = prj1(current_position) + 1 ∧ y = prj2(current_position) ∧ x ∈ 1‥ WIDTH ∧ y ∈ 1‥ DEPTH ∧ val ∈ {1,2} ∧&#10;                 (((concrete_left_sensor ≥ (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE) ∧ concrete_left_sensor &lt; GRID_SIZE + (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE)) ∧ val = 2) ∨ (concrete_left_sensor ≥ GRID_SIZE + (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE) ∧ val = 1)) ∣ x ↦ y ↦ val} ∪&#10;&#10;                 {x,y,val · x = prj1(current_position) ∧ y = prj2(current_position) + 1 ∧ x ∈ 1‥ WIDTH ∧ y ∈ 1‥ DEPTH ∧ val ∈ {1,2} ∧&#10;                 (((concrete_forward_sensor ≥ (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE) ∧ concrete_forward_sensor &lt; GRID_SIZE + (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE)) ∧ val = 2) ∨ ((concrete_forward_sensor ≥ GRID_SIZE + (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE)) ∧ val = 1)) ∣ x ↦ y ↦ val} ∪&#10;&#10;                 {x,y,val · x = prj1(current_position) ∧ y = prj2(current_position) − 1 ∧ x ∈ 1‥ WIDTH ∧ y ∈ 1‥ DEPTH ∧ val ∈ {1,2} ∧&#10;                 (((concrete_backward_sensor ≥ prj2(concrete_position) mod GRID_SIZE ∧ concrete_backward_sensor &lt; GRID_SIZE + prj2(concrete_position) mod GRID_SIZE) ∧ val = 2) ∨ ((concrete_backward_sensor ≥ GRID_SIZE + prj2(concrete_position) mod GRID_SIZE) ∧ val = 1)) ∣ x ↦ y ↦ val})&#10;  end&#10;&#10;  event SYNCHRONIZE_BATTERY extends SYNCHRONIZE_BATTERY&#10;  end&#10;&#10;  event UPDATE_POSITION refines UPDATE_POSITION&#10;    any concrete_x concrete_y&#10;    where&#10;      @grd_x concrete_x ∈ ℤ&#10;      @grd_y concrete_y ∈ ℤ&#10;      @grd_emergency_mode emergency_mode = FALSE&#10;      @grd_Battery battery &gt; BATTERY_STEP&#10;      @grd_battery_actual battery_actual = TRUE&#10;    with&#10;      @x x = MAP_TO_ABSTRACT_POS(concrete_x)&#10;      @y y = MAP_TO_ABSTRACT_POS(concrete_y)&#10;    then&#10;      @act_update_position position_actual ≔ TRUE&#10;      @act_battery_actual battery_actual ≔ FALSE&#10;      @act_pos current_position ≔ MAP_TO_ABSTRACT_POS(concrete_x) ↦ MAP_TO_ABSTRACT_POS(concrete_y)&#10;      @act_visited visited ≔ {TRUE ↦ visited ∪ {MAP_TO_ABSTRACT_POS(concrete_x) ↦ MAP_TO_ABSTRACT_POS(concrete_y)}, FALSE ↦ visited}(bool(MAP_TO_ABSTRACT_POS(concrete_x) ↦ MAP_TO_ABSTRACT_POS(concrete_y) ∈ (1‥ WIDTH) × (1‥DEPTH)))&#10;      @act_concrete_pos concrete_position ≔ concrete_x ↦ concrete_y&#10;      @act_emergency_mode emergency_mode ≔ bool(MAP_TO_ABSTRACT_POS(concrete_x) ↦ MAP_TO_ABSTRACT_POS(concrete_y) ∉ (1‥ WIDTH) × (1‥DEPTH))&#10;  end&#10;end&#10;" version="5">
    <org.eventb.core.refinesMachine name="'" org.eventb.core.target="M5_Quadcopter_Mission_Status"/>
    <org.eventb.core.seesContext name="_3BzvgOGBEfCu9c2s4XMQ6Q" org.eventb.core.target="M6_Quadcopter_Concrete_Movement_Ctx"/>
    <org.eventb.core.variable name="_B2viwOADEfC8NKsWk45csw" org.eventb.core.generated="false" org.eventb.core.identifier="mode"/>
    <org.eventb.core.variable name="_gkpagOADEfC8NKsWk45csw" org.eventb.core.generated="false" org.eventb.core.identifier="sensor_data_actual"/>
    <org.eventb.core.variable name="_hVQVwOF8EfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.identifier="position_actual"/>
    <org.eventb.core.variable name="_HZui0OAGEfC8NKsWk45csw" org.eventb.core.generated="false" org.eventb.core.identifier="battery"/>
    <org.eventb.core.variable name="_r0nJIOJDEfCN5cCo6lgIJA" org.eventb.core.generated="false" org.eventb.core.identifier="battery_actual"/>
    <org.eventb.core.variable name="_PnAQ0OAHEfC8NKsWk45csw" org.eventb.core.generated="false" org.eventb.core.identifier="current_position"/>
    <org.eventb.core.variable name="_PnAQ0eAHEfC8NKsWk45csw" org.eventb.core.generated="false" org.eventb.core.identifier="visited"/>
    <org.eventb.core.variable name="_PnAQ0uAHEfC8NKsWk45csw" org.eventb.core.generated="false" org.eventb.core.identifier="field"/>
    <org.eventb.core.variable name="_jHZBwOF8EfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.identifier="emergency_mode"/>
    <org.eventb.core.variable name="_S23BkOATEfC8NKsWk45csw" org.eventb.core.generated="false" org.eventb.core.identifier="mission_failed"/>
    <org.eventb.core.event name="_jHZBwOF8EfCu9c2s4XMQ6R" org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="INITIALISATION">
        <org.eventb.core.action name="_RjL8cOGCEfCu9c2s4XMQ6Q" org.eventb.core.assignment="concrete_position :∣ prj1(concrete_position') ∈ MAP_TO_ABSTRACT_POS∼[{prj1(BASE_POSITION)}] ∧ prj2(concrete_position') ∈ MAP_TO_ABSTRACT_POS∼[{prj2(BASE_POSITION)}]" org.eventb.core.generated="false" org.eventb.core.label="init_concrete_pos"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_jHZBwOF8EfCu9c2s4XMQ6S" org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="TAKEOFF">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="TAKEOFF"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_jHZBwOF8EfCu9c2s4XMQ6U" org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="MOVE_RIGHT">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="MOVE_RIGHT"/>
        <org.eventb.core.guard name="_9RYBYOGHEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="grd_concrete_pos_does_not_move_outside" org.eventb.core.predicate="prj1(concrete_position) ≥ GRID_SIZE"/>
        <org.eventb.core.action name="_q7eoIOGHEfCu9c2s4XMQ6Q" org.eventb.core.assignment="concrete_position :∣ prj1(concrete_position') ∈ MAP_TO_ABSTRACT_POS∼[{prj1(current_position) − 1}] ∧ prj2(concrete_position') = prj2(concrete_position)" org.eventb.core.generated="false" org.eventb.core.label="act_concrete_pos"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_jHZBwOF8EfCu9c2s4XMQ6T" org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="MOVE_LEFT">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="MOVE_LEFT"/>
        <org.eventb.core.guard name="_9RYocOGHEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="grd_concrete_pos_does_not_move_outside" org.eventb.core.predicate="prj1(concrete_position) ≤ CONCRETE_WIDTH − GRID_SIZE"/>
        <org.eventb.core.action name="_tBD0kOGHEfCu9c2s4XMQ6Q" org.eventb.core.assignment="concrete_position :∣ prj1(concrete_position') ∈ MAP_TO_ABSTRACT_POS∼[{prj1(current_position) + 1}] ∧ prj2(concrete_position') = prj2(concrete_position)" org.eventb.core.generated="false" org.eventb.core.label="act_concrete_pos"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_jHZBwOF8EfCu9c2s4XMQ6W" org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="MOVE_BACKWARD">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="MOVE_BACKWARD"/>
        <org.eventb.core.guard name="_EDq0kOGIEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="grd_concrete_pos_does_not_move_outside" org.eventb.core.predicate="prj2(concrete_position)≥ GRID_SIZE"/>
        <org.eventb.core.action name="_veZZsOGHEfCu9c2s4XMQ6Q" org.eventb.core.assignment="concrete_position :∣ prj1(concrete_position') = prj1(concrete_position) ∧ prj2(concrete_position') ∈ MAP_TO_ABSTRACT_POS∼[{prj2(current_position) − 1}]" org.eventb.core.generated="false" org.eventb.core.label="act_concrete_pos"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_jHZBwOF8EfCu9c2s4XMQ6V" org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="MOVE_FORWARD">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="MOVE_FORWARD"/>
        <org.eventb.core.guard name="_EDsCsOGIEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="grd_concrete_pos_does_not_move_outside" org.eventb.core.predicate="prj2(concrete_position) ≤ CONCRETE_DEPTH − GRID_SIZE"/>
        <org.eventb.core.action name="_veaAwOGHEfCu9c2s4XMQ6Q" org.eventb.core.assignment="concrete_position :∣ prj1(concrete_position') = prj1(concrete_position) ∧ prj2(concrete_position') ∈ MAP_TO_ABSTRACT_POS∼[{prj2(current_position) + 1}]" org.eventb.core.generated="false" org.eventb.core.label="act_concrete_pos"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_jHZBwOF8EfCu9c2s4XMQ6X" org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="LAND">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="LAND"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_jHZBwOF8EfCu9c2s4XMQ6Y" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="OBSERVE">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="OBSERVE"/>
        <org.eventb.core.guard name="_1GsNAOGJEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="grd_concrete_left_sensor" org.eventb.core.predicate="concrete_left_sensor ∈ ℕ"/>
        <org.eventb.core.guard name="_1Gs0EOGJEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="grd_concrete_right_sensor" org.eventb.core.predicate="concrete_right_sensor ∈ ℕ"/>
        <org.eventb.core.guard name="_1Gs0EeGJEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="grd_concrete_forward_sensor" org.eventb.core.predicate="concrete_forward_sensor ∈ ℕ"/>
        <org.eventb.core.guard name="_1Gs0EuGJEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="grd_concrete_backward_sensor" org.eventb.core.predicate="concrete_backward_sensor ∈ ℕ"/>
        <org.eventb.core.guard name="_aUl2IOHOEfC0NdyoK1GV1g" org.eventb.core.generated="false" org.eventb.core.label="grd_emergency" org.eventb.core.predicate="emergency_mode = FALSE"/>
        <org.eventb.core.guard name="_UsXk8eADEfC8NKsWk45csw" org.eventb.core.generated="false" org.eventb.core.label="grd_mode" org.eventb.core.predicate="mode = FLYING"/>
        <org.eventb.core.action name="_oZeBsOADEfC8NKsWk45csw" org.eventb.core.assignment="sensor_data_actual ≔ TRUE" org.eventb.core.generated="false" org.eventb.core.label="act_sensor_data_actual"/>
        <org.eventb.core.guard name="_UFnrsOF8EfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="grd_position" org.eventb.core.predicate="position_actual = TRUE"/>
        <org.eventb.core.action name="_-IODYOJDEfCN5cCo6lgIJA" org.eventb.core.assignment="battery_actual ≔ FALSE" org.eventb.core.generated="false" org.eventb.core.label="act_battery_actual"/>
        <org.eventb.core.action name="_cjAiUuAJEfC8NKsWk45csw" org.eventb.core.assignment="field ≔ field  (&#10;                 {x,y,val · x = prj1(current_position) ∧ y = prj2(current_position) ∧ x ∈ 1‥ WIDTH ∧ y ∈ 1‥ DEPTH ∧ val ∈ {1,2} ∧&#10;                 (((concrete_right_sensor &lt; prj1(concrete_position) mod GRID_SIZE ∨ concrete_left_sensor &lt; (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE) ∨ concrete_forward_sensor &lt; (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE) ∨ concrete_backward_sensor &lt; prj2(concrete_position) mod GRID_SIZE) ∧ val = 2) ∨ (¬(concrete_right_sensor &lt; prj1(concrete_position) mod GRID_SIZE ∨ concrete_left_sensor &lt; (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE) ∨ concrete_forward_sensor &lt; (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE) ∨ concrete_backward_sensor &lt; prj2(concrete_position) mod GRID_SIZE) ∧ val = 1)) ∣ x ↦ y ↦ val} ∪&#10;&#10;                 {x,y,val · x = prj1(current_position) − 1 ∧ y = prj2(current_position) ∧ x ∈ 1‥ WIDTH ∧ y ∈ 1‥ DEPTH ∧ val ∈ {1,2} ∧&#10;                 (((concrete_right_sensor ≥ prj1(concrete_position) mod GRID_SIZE ∧ concrete_right_sensor &lt; GRID_SIZE + prj1(concrete_position) mod GRID_SIZE) ∧ val = 2) ∨ ((concrete_right_sensor ≥ GRID_SIZE + prj1(concrete_position) mod GRID_SIZE) ∧ val = 1)) ∣ x ↦ y ↦ val} ∪&#10;&#10;                 {x,y,val · x = prj1(current_position) + 1 ∧ y = prj2(current_position) ∧ x ∈ 1‥ WIDTH ∧ y ∈ 1‥ DEPTH ∧ val ∈ {1,2} ∧&#10;                 (((concrete_left_sensor ≥ (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE) ∧ concrete_left_sensor &lt; GRID_SIZE + (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE)) ∧ val = 2) ∨ (concrete_left_sensor ≥ GRID_SIZE + (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE) ∧ val = 1)) ∣ x ↦ y ↦ val} ∪&#10;&#10;                 {x,y,val · x = prj1(current_position) ∧ y = prj2(current_position) + 1 ∧ x ∈ 1‥ WIDTH ∧ y ∈ 1‥ DEPTH ∧ val ∈ {1,2} ∧&#10;                 (((concrete_forward_sensor ≥ (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE) ∧ concrete_forward_sensor &lt; GRID_SIZE + (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE)) ∧ val = 2) ∨ ((concrete_forward_sensor ≥ GRID_SIZE + (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE)) ∧ val = 1)) ∣ x ↦ y ↦ val} ∪&#10;&#10;                 {x,y,val · x = prj1(current_position) ∧ y = prj2(current_position) − 1 ∧ x ∈ 1‥ WIDTH ∧ y ∈ 1‥ DEPTH ∧ val ∈ {1,2} ∧&#10;                 (((concrete_backward_sensor ≥ prj2(concrete_position) mod GRID_SIZE ∧ concrete_backward_sensor &lt; GRID_SIZE + prj2(concrete_position) mod GRID_SIZE) ∧ val = 2) ∨ ((concrete_backward_sensor ≥ GRID_SIZE + prj2(concrete_position) mod GRID_SIZE) ∧ val = 1)) ∣ x ↦ y ↦ val})" org.eventb.core.generated="false" org.eventb.core.label="act_field"/>
        <org.eventb.core.parameter name="_1GtbIOGJEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.identifier="concrete_left_sensor"/>
        <org.eventb.core.parameter name="_1GtbIeGJEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.identifier="concrete_right_sensor"/>
        <org.eventb.core.parameter name="_1GtbIuGJEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.identifier="concrete_forward_sensor"/>
        <org.eventb.core.parameter name="_1GtbI-GJEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.identifier="concrete_backward_sensor"/>
        <org.eventb.core.witness name="_Wp6FAOGKEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="right_sensor" org.eventb.core.predicate="(concrete_right_sensor &lt; prj1(concrete_position) mod GRID_SIZE ∧ right_sensor = 0) ∨ (concrete_right_sensor ≥ prj1(concrete_position) mod GRID_SIZE ∧ concrete_right_sensor &lt; GRID_SIZE + prj1(concrete_position) mod GRID_SIZE ∧ right_sensor = 2) ∨ ((concrete_right_sensor ≥ GRID_SIZE + prj1(concrete_position) mod GRID_SIZE) ∧ right_sensor = 1)"/>
        <org.eventb.core.witness name="_Wp5d8OGKEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="left_sensor" org.eventb.core.predicate="(concrete_left_sensor &lt; (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE) ∧ left_sensor = 0) ∨ (concrete_left_sensor ≥ (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE) ∧ concrete_left_sensor &lt; GRID_SIZE + (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE) ∧ left_sensor = 2) ∨ ((concrete_left_sensor ≥ GRID_SIZE + (GRID_SIZE − prj1(concrete_position) mod GRID_SIZE)) ∧ left_sensor = 1)"/>
        <org.eventb.core.witness name="_Wp6sEeGKEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="backward_sensor" org.eventb.core.predicate="(concrete_backward_sensor &lt; prj2(concrete_position) mod GRID_SIZE ∧ backward_sensor = 0) ∨ (concrete_backward_sensor ≥ prj2(concrete_position) mod GRID_SIZE ∧ concrete_backward_sensor &lt; GRID_SIZE + prj2(concrete_position) mod GRID_SIZE ∧ backward_sensor = 2) ∨ ((concrete_backward_sensor ≥ GRID_SIZE + prj2(concrete_position) mod GRID_SIZE) ∧ backward_sensor = 1)"/>
        <org.eventb.core.guard name="_Pl-TsOJEEfCN5cCo6lgIJA" org.eventb.core.generated="false" org.eventb.core.label="grd_Battery" org.eventb.core.predicate="battery &gt; BATTERY_STEP"/>
        <org.eventb.core.guard name="_-IPRgOJDEfCN5cCo6lgIJA" org.eventb.core.generated="false" org.eventb.core.label="grd_battery_actual" org.eventb.core.predicate="battery_actual = TRUE"/>
        <org.eventb.core.witness name="_BatCUOsMEfCthOk2wWjR-w" org.eventb.core.generated="false" org.eventb.core.label="forward_sensor" org.eventb.core.predicate="(concrete_forward_sensor &lt; (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE) ∧ forward_sensor = 0) ∨ (concrete_forward_sensor ≥ (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE) ∧ concrete_forward_sensor &lt; GRID_SIZE + (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE) ∧ forward_sensor = 2) ∨ ((concrete_forward_sensor ≥ GRID_SIZE + (GRID_SIZE − prj2(concrete_position) mod GRID_SIZE)) ∧ forward_sensor = 1)"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_jHZBwOF8EfCu9c2s4XMQ6Z" org.eventb.core.convergence="0" org.eventb.core.extended="true" org.eventb.core.generated="false" org.eventb.core.label="SYNCHRONIZE_BATTERY">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="SYNCHRONIZE_BATTERY"/>
    </org.eventb.core.event>
    <org.eventb.core.event name="_jHZBwOF8EfCu9c2s4XMQ6[" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="UPDATE_POSITION">
        <org.eventb.core.refinesEvent name="'" org.eventb.core.target="UPDATE_POSITION"/>
        <org.eventb.core.action name="_Pe5_QOF8EfCu9c2s4XMQ6Q" org.eventb.core.assignment="position_actual ≔ TRUE" org.eventb.core.generated="false" org.eventb.core.label="act_update_position"/>
        <org.eventb.core.guard name="_vOqLAOF7EfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="grd_x" org.eventb.core.predicate="concrete_x ∈ ℤ"/>
        <org.eventb.core.guard name="_vOqyEOF7EfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="grd_y" org.eventb.core.predicate="concrete_y ∈ ℤ"/>
        <org.eventb.core.action name="_-IP4kOJDEfCN5cCo6lgIJA" org.eventb.core.assignment="battery_actual ≔ FALSE" org.eventb.core.generated="false" org.eventb.core.label="act_battery_actual"/>
        <org.eventb.core.action name="_vOsAMOF7EfCu9c2s4XMQ6Q" org.eventb.core.assignment="current_position ≔ MAP_TO_ABSTRACT_POS(concrete_x) ↦ MAP_TO_ABSTRACT_POS(concrete_y)" org.eventb.core.generated="false" org.eventb.core.label="act_pos"/>
        <org.eventb.core.action name="_lhBToOyVEfCPM4v5mgUqKg" org.eventb.core.assignment="visited ≔ {TRUE ↦ visited ∪ {MAP_TO_ABSTRACT_POS(concrete_x) ↦ MAP_TO_ABSTRACT_POS(concrete_y)}, FALSE ↦ visited}(bool(MAP_TO_ABSTRACT_POS(concrete_x) ↦ MAP_TO_ABSTRACT_POS(concrete_y) ∈ (1‥ WIDTH) × (1‥DEPTH)))" org.eventb.core.generated="false" org.eventb.core.label="act_visited"/>
        <org.eventb.core.action name="_xGaD4OGIEfCu9c2s4XMQ6Q" org.eventb.core.assignment="concrete_position ≔ concrete_x ↦ concrete_y" org.eventb.core.generated="false" org.eventb.core.label="act_concrete_pos"/>
        <org.eventb.core.action name="_vOtOUOF7EfCu9c2s4XMQ6Q" org.eventb.core.assignment="emergency_mode ≔ bool(MAP_TO_ABSTRACT_POS(concrete_x) ↦ MAP_TO_ABSTRACT_POS(concrete_y) ∉ (1‥ WIDTH) × (1‥DEPTH))" org.eventb.core.generated="false" org.eventb.core.label="act_emergency_mode"/>
        <org.eventb.core.parameter name="_hkl70OGIEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.identifier="concrete_x"/>
        <org.eventb.core.parameter name="_hkmi4OGIEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.identifier="concrete_y"/>
        <org.eventb.core.witness name="_hkmi4eGIEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="x" org.eventb.core.predicate="x = MAP_TO_ABSTRACT_POS(concrete_x)"/>
        <org.eventb.core.witness name="_i2Zh8OGIEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="y" org.eventb.core.predicate="y = MAP_TO_ABSTRACT_POS(concrete_y)"/>
        <org.eventb.core.guard name="_ps2K0OHUEfC0NdyoK1GV1g" org.eventb.core.generated="false" org.eventb.core.label="grd_emergency_mode" org.eventb.core.predicate="emergency_mode = FALSE"/>
        <org.eventb.core.guard name="_Pl_h0OJEEfCN5cCo6lgIJA" org.eventb.core.generated="false" org.eventb.core.label="grd_Battery" org.eventb.core.predicate="battery &gt; BATTERY_STEP"/>
        <org.eventb.core.guard name="_-IQfoOJDEfCN5cCo6lgIJA" org.eventb.core.generated="false" org.eventb.core.label="grd_battery_actual" org.eventb.core.predicate="battery_actual = TRUE"/>
    </org.eventb.core.event>
    <org.eventb.core.variable name="_FKUiUOGCEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.identifier="concrete_position"/>
    <org.eventb.core.invariant name="_aOLWoOGCEfCu9c2s4XMQ6Q" org.eventb.core.generated="false" org.eventb.core.label="conrete_pos_type" org.eventb.core.predicate="concrete_position ∈ ℤ × ℤ"/>
    <org.eventb.core.invariant name="_s1e-oOHzEfC0NdyoK1GV1g" org.eventb.core.generated="false" org.eventb.core.label="glueing_inv_1" org.eventb.core.predicate="prj1(concrete_position) ∈ MAP_TO_ABSTRACT_POS∼[{prj1(current_position)}]"/>
    <org.eventb.core.invariant name="_s1flsOHzEfC0NdyoK1GV1g" org.eventb.core.generated="false" org.eventb.core.label="glueing_inv_2" org.eventb.core.predicate="prj2(concrete_position) ∈ MAP_TO_ABSTRACT_POS∼[{prj2(current_position)}]"/>
</org.eventb.core.machineFile>
